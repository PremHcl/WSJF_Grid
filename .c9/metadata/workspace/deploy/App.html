{"filter":false,"title":"App.html","tooltip":"/deploy/App.html","undoManager":{"mark":1,"position":1,"stack":[[{"group":"doc","deltas":[{"start":{"row":9,"column":82},"end":{"row":9,"column":192},"action":"remove","lines":["items:{html:'<a href=\"https://help.rallydev.com/apps/2.0rc3/doc/\">App SDK 2.0rc3 Docs</a>'},launch:function(){"]},{"start":{"row":9,"column":82},"end":{"row":9,"column":2808},"action":"insert","lines":["launch:function(){this.releaseCombobox=this.add({xtype:\"rallyreleasecombobox\",allowNoEntry:!0,listeners:{ready:this._addPICombobox,change:this._onReleaseComboboxChanged,scope:this}})},_addPICombobox:function(){console.log(\"PI Combobox added\"),this.piCombobox=this.add({xtype:\"rallyportfolioitemtypecombobox\",defaultSelectionPosition:\"last\",listeners:{ready:this._onPICombobox,change:this._onPICombobox,scope:this}})},_onPICombobox:function(){var selectedType=this.piCombobox.getRecord(),query=[];0===this.piCombobox.getRecord().get(\"Ordinal\")&&(query=this.releaseCombobox.getQueryFromSelected()),console.log(\"query: \",query),Rally.data.ModelFactory.getModel({type:selectedType.get(\"TypePath\"),success:function(model){if(void 0===this._myGrid)Ext.create(\"Rally.data.WsapiDataStore\",{model:model,autoLoad:!0,filters:query,remoteSort:!1,listeners:{load:function(store,records,success){this._updateGrid(store)},update:function(store,rec,modified,opts){this._calculateScore([rec])},scope:this},fetch:[\"Name\",\"FormattedID\",\"Release\",\"TimeCriticality\",\"RROEValue\",\"UserBusinessValue\",\"ValueScore\",\"JobSize\"]});else{this._myGrid.reconfigureWithModel(model);var store=this._myGrid.getStore();store.clearFilter(!0),store.filter(query);var that=this;store.addListener(\"update\",function(store,rec,modified,opts){that._calculateScore([rec])}),store.addListener(\"load\",function(store,records,modified,opts){that._calculateScore(records),that._updateGrid(store)})}},scope:this})},_onReleaseComboboxChanged:function(){if(this.piCombobox&&0===this.piCombobox.getRecord().get(\"Ordinal\")&&this._myGrid){var store=this._myGrid.getStore();store.clearFilter(!0),store.filter(this.releaseCombobox.getQueryFromSelected())}},_calculateScore:function(records){Ext.Array.each(records,function(feature){var jobSize=feature.data.JobSize,timeValue=feature.data.TimeCriticality,OERR=feature.data.RROEValue,userValue=feature.data.UserBusinessValue,oldScore=feature.data.ValueScore;if(jobSize>0){var score=Math.floor((userValue+timeValue+OERR)/jobSize+.5);oldScore!==score&&feature.set(\"ValueScore\",score)}})},_createGrid:function(myStore){console.log(\"Creating Grid\"),this._myGrid=Ext.create(\"Rally.ui.grid.Grid\",{xtype:\"rallygrid\",title:\"Feature Scoring Grid\",height:\"98%\",store:myStore,selType:\"cellmodel\",columnCfgs:[{text:\"Portfolio ID\",dataIndex:\"FormattedID\",flex:1,xtype:\"templatecolumn\",tpl:Ext.create(\"Rally.ui.renderer.template.FormattedIDTemplate\")},{text:\"Name\",dataIndex:\"Name\",flex:2},\"TimeCriticality\",\"RROEValue\",\"UserBusinessValue\",\"JobSize\",{text:\"Score\",dataIndex:\"ValueScore\",editor:null}],scope:this}),this.add(this._myGrid)},_updateGrid:function(myStore){void 0===this._myGrid?this._createGrid(myStore):this._myGrid.reconfigure(myStore)"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":1160},"end":{"row":9,"column":1165},"action":"remove","lines":["Value"]},{"start":{"row":9,"column":1160},"end":{"row":9,"column":1164},"action":"insert","lines":["WSJF"]},{"start":{"row":9,"column":2019},"end":{"row":9,"column":2024},"action":"remove","lines":["Value"]},{"start":{"row":9,"column":2019},"end":{"row":9,"column":2023},"action":"insert","lines":["WSJF"]},{"start":{"row":9,"column":2134},"end":{"row":9,"column":2139},"action":"remove","lines":["Value"]},{"start":{"row":9,"column":2134},"end":{"row":9,"column":2138},"action":"insert","lines":["WSJF"]},{"start":{"row":9,"column":2613},"end":{"row":9,"column":2618},"action":"insert","lines":["WSJF "]},{"start":{"row":9,"column":2636},"end":{"row":9,"column":2641},"action":"remove","lines":["Value"]},{"start":{"row":9,"column":2636},"end":{"row":9,"column":2640},"action":"insert","lines":["WSJF"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":27,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1417817305073,"hash":"e26d6743b4e8f1cd170cd3b99afd36b4247ce331"}